d <- data.table("calibration-full-fixed-tmp.csv", header=T)
d <- read.table("calibration-full-fixed-tmp.csv", header=T)
plot(d$ch0, d$x)
dfit <- lm( d$ch0 ~ d$x )
dfit
plot(dfit)
summary(dfit)
plot(dfit)
d <- read.table("calibration-full-fixed.txt", header=T)
dfit <- lm( d$ch0 ~ d$x )
plot(d$ch0, d$x)
plot(dfit)
plot(d$ch0, d$x)
plot(d$ch0, d$x)
abline(dfit, col="red")
plot(d$x, d$ch0)
abline(dfit, col="red")
plot(d$x, d$ch0, pch='')
plot(d$x, d$ch0, pch='')plot(d$x, d$ch0, pch='')
resid(dfit)
plot(resid(dfit))
d.sub1 <- subset(d, x > 500 & x < 600)
plot(d.sub1$x, d.sub1$ch0)
abline(dfit)
d.sub1 <- subset(d, x > 500 & x < 1100)
plot(d.sub1$x, d.sub1$ch0)
abline(dfit)
d.sub1 <- subset(d, x > 700 & x < 1100)
abline(dfit, col="red")
plot(d.sub1$x, d.sub1$ch0 - dfit)
e <- data.frame(x=d$x, ch0=d$x + 20)
e
f <- range(d)
f
yhat <- predict(dfit, newdata = data.frame(x=f)
plot(yhat)
yhat <- predict(dfit, newdata = data.frame(x=f))
d <- read.table("calibration-full-fixed.txt", header=T)
dfit <- lm(d$ch0 ~ d$x)
summary(dfit)
dsub <- subset(d, d$x > 256 & d$x < (65535 - 256))
dsub.fit <- lm(dsub$ch0 ~ dsub$x)
summary(dsub.fit)
dsub <- subset(d, d$x > 512 & d$x < (65535 - 512))
dsub.fit <- lm(dsub$ch0 ~ dsub$x)
plot(dsub.fit)
dsub.pred <- predict(dsub.fit)
head(dsub.pred)
dim(dsub.fit)
size(dsub.fit)
nrow(dsbut.pred)
dim(dsub.pred)
size(dsub.pred)
nrow(dsub.pred)
ncol(dsub.pred)
dim(dsub.pred)
dsub.pred
plot(dsub$ch0 - dsub.pred, dsub$x)
plot(dsub$x, dsub$ch0 - dsub.pred)
e <- data.frame(x=d$x, ch0=d$ch0 * 4.096 / 32768)
plot(e$x, e$ch0)
e.fit <- lm(e$ch0 ~ e$x)
e.pred <- predict(e.fit)
plot(e$x, e.pred$ch0 - e$ch0)
plot(e$x, e.pred - e$ch0)
plot(e$x, e.pred - e$ch0, type='l')
mean(e.pred - e$ch0)
sd(e.pred - e$ch0)
1/65535
400e-6
1/(4e-4)
ln(2500)/ln(2)
log(2500)/log(2)
clear()
reset
quit
quit(F)
quit("no")
d <- read.table("calibration-difference-channels.txt",header=T)
plot(d$x, d$ch01)
d.fit <- lm(d$ch01 ~ d$x)
plot(d.fit)
summary(d.fit)
d$v.ch01 <- d$ch01 * 4.096/32768
plot(d$x, d$v.ch01)
plot(d$x, d$v.ch01,type='l')
d.vfit <- lm(d$v.ch01 ~ d$x)
d.vpred <- predict(d.vfit)
plot(d$x, d$v.ch01 - d.vpred, type='l')
d.vfitpoly <- lm(d$v.ch01 ~ poly(d$x, 2, raw=TRUE))
d.vpredpoly <- predict(d.vfitpoly)
summary(d.vfitpoly)
plot(d.vfitpoly)
plot(d$x, d$v.ch01 - d.vpredpoly, type='l')
d$vx <- (d$x - 32768) * 3.3 / 32768
d.vvfitpoly <- lm(d$v.ch01 ~ poly(d$vx, 2, raw=TRUE))
summary(d.vvfitpoly)
d.vvpred <- predict(d.vvfitpoly)
plot(d$x, d$v.ch01 - d.vv, type='l')
plot(d$x, d$v.ch01 - d.vvpred, type='l')
plot(d$vx, d$v.ch01 - d.vvpred, type='l')
dsub = subset(d, vx > -1 & vx < 1)
plot(dsub)
plot(dsub$vx, dsub$v.ch01)
dsub.vvfit <- lm(dsub$v.ch01 ~ poly(dsub$vx, 2, raw=TRUE))
dsub.vvpred <- predict(dsub.vvfit)
plot(dsub$vx, dsub$v.ch01 - dsub.vvpred)
sd(dsub$v.ch01 - dsub.vvpred)
3.3/0.000159
log(3.3/0.000159)/log(2)
d
reset()
clear()
rm(list = ls())
d <- read.table("calibration-difference-channels.txt")
d.lm <- lm(d$x ~ d$ch01)
d <- read.table("calibration-difference-channels.txt", header=T)
d.lm <- lm(d$x ~ d$ch01)
summary(d.lm)
d.pred <- predict(d.lm)
plot(d$x, d.pred)
plot(d$x, d.pred - d$ch01)
plot(d$x, d.pred - d$ch01)
plot(d$x, d.pred - d$ch01)  C-c C-c
d.lm <- lm(d$ch01 ~ d$x)
d.pred <- predict(d.lm)
plot(d$x, d.pred - d$ch01)
min(d$ch01)
 max(d$ch01) - min(d$ch01)
max(abs(d$ch01 - d.pred))
50125/64.79
log(773.6533)/log(2)
d.lmp <- lm(d$ch01 ~ poly(d$x, 2, raw=TRUE))
d.predp <- predict(d.lmp)
plot(d$x, d.predp - d$ch01)
max(abs(d$ch01 - d.predp))
log(50125/18.54076)/log(2)
plot(d$x, d.predp - d$ch01, type='l')
plot(d$x, d.pred - d$ch01, type='l')
d$x1 <- floor(d$x / 256)
 257 %% 256
d$x2 <- d$x %% 256
d$split.lm <- lm(d$ch01 ~ d$x1 + d$x2)
head d$x2
head(d$x2)
d$x2
d$split.lm <- lm(d$ch01 ~ d$x1 + d$x2)
d$split.lm <- lm(ch01 ~ x1 + x2, data=d)
size(d$x1)
dim(d$x1)
nrow(d$x1)
ncol(d$x1)
d$x1
d$x2
ncol(d$ch01)
d$ch01
d$x1
d$ch01
len(d)
length(d)
size(d)
dim(d)
d$x1 <- floor(d$x / 256)
length(d$x1)
length(d$x2)
length(d$ch01)
d$split.lm <- lm(ch01 ~ x1 + x2, data=d)
d.split.lm <- lm(ch01 ~ x1 + x2, data=d)
d.split.pred <- predict(d.split.lm)
plot(d$x, d$ch01 - d.split.pred)
summary(d.split.pred)
summary(d.split.lm)
195/0.774
d.start <- subset(d, d$x < 512)
plot(d.start$x, d.start$ch01)
plot(d.start$x, d.start$ch01, type='l')
d.endpoints <- subset(d, d$x2 < 5 | d$x2 > 250)
plot(d.endpoints$x, d.endpoints$ch01)
plot(d.endpoints$x, d.endpoints$ch01, type='l')
plot(d.endpoints$x2, d.endpoints$ch01)
plot(d$x2, d.split.pred - d$ch01)
e <- subset(d, x2 = 128)
e
e <- subset(d, x2 == 128)
e
plot(e$x, e$ch01)
e.lm <- lm(e$ch01 ~ e$x)
summary(e.lm)
e.pred <- predict(e.lm)
plot(e$x, e.pred - e$ch01)
f <- subset(d, d$x > 2048 & d$x < (65535-2048) & d$x2 == 128)
f.lm <- lm(f$ch01 ~ f$x)
f.pred <- predict(f.lm, newdata=d)
f.pred <- predict(f.lm, newdata=d$x)
d
f.lm <- lm(f$ch01 ~ f$x)
plot(f.lm)
f.pred <- predict(f.lm, newdata=d)
coeffs = coefficients(f.lm)
coeffs
f.pred <- coeffs[0] + coeffs[1]*d$x
plot(d$x, d$ch01 - f.pred)
size(d$x)
length(d$x)
length(f.pred)
f.pred <- data.frame(p=coeffs[0] + coeffs[1]*d$x)
length(f.pred)
 f.pred <- d$x * coeffs[1] + coeffs[0]
f.pred
 >f.pred <- sapply(d$x, function(x) coeffs[1]*x + coeffs[0])
f.pred <- sapply(d$x, function(x) coeffs[1]*x + coeffs[0])
length(f.pred)
plot(d$x, d$ch01 - f.pred)
f.pred
library(plyr)
install.packages('plyr')
library(plyr)
f.pred <- mdply(d, function(x) { coeffs[1] * x + coeffs[0] })
f.pred <- mdply(d, function(x, x1, x2, ch01, ch23) { coeffs[1] * x + coeffs[0] })
